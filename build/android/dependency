#!/bin/sh
set -e

if [ $# -lt 2 ]; then
    echo "usage: $0 NDK_DIR spec" 1>&2
    exit 1
fi

ROOTDIR=$(cd $(dirname $0)/../.. && pwd -P)
BUILDDIR=$ROOTDIR/build
NEWSCRIPTDIR=$ROOTDIR/script/build
ANDROIDDIR=$BUILDDIR/android

NDK_DIR=$1
SPEC=$2

echo ""
echo "Cross-compiling $SPEC for all archs"

ALL_ARCHS="armeabi armeabi-v7a arm64 mips mips64 x86 x86_64"

for ARCH in $ALL_ARCHS; do
    echo ""
    echo "Cross compiling $SPEC for arch ${ARCH}"
    $NEWSCRIPTDIR/android-toolchain ${NDK_DIR} ${ARCH}
    $NEWSCRIPTDIR/cross-android ${ARCH} $NEWSCRIPTDIR/$SPEC
done
